# S3

`S3は耐久性と可用性が非常に高く、データの中長期保存に最適なストレージ`

## S3 のユースケース

`コンテンツ配信用の画像データなどをS3に保存して、CloudFrontを利用して配信する`

![picture 1](images/6f9fb020b5fd9f9531069eaddcb4dc6e89f46b3402f63f05d64159220ae801f7.png)

## S3 ストレージの特徴

- ブロックストレージ
  - EC2 にアタッチして活用するディスクサービス
  - ブロック形式でデータを保存
  - 高速・広帯域幅
  - 例：EBS、インスタンスストア
- オブジェクトストレージ
  - 安価かつ高い耐久性をもつオンラインストレージ
  - オブジェクト形式でデータを保存
  - デフォルトで複数 AZ に冗長化されている
  - 例：S3、Glacier
- ファイルストレージ
  - 複数の EC2 インスタンスから同時にアタッチ可能な共有ストレージサービス
  - ファイル形式でデータを保存
  - 例：EFS

## S3 のデータ容量制限

**バケット**

オブジェクトの保存場所。リージョンに設置されるため、名前はグローバルでユニークにする。`データの保存容量は無制限であり、自動でストレージ容量が拡張される。`

**オブジェクト**

S3 に格納されるファイル形式で、オブジェクトに対して URL が付与される。バケット内に`保存可能なオブジェクト数は無制限。`

**保存可能なオブジェクトサイズの制限**

オブジェクトあたりのデータサイズは`0KBから5TBまで保存可能。`

## S3 の利用コスト

`ストレージのコストを比較するとインスタンスストアを除けば、最も値段が安いのはGlacier deep archive`

- S3 のデータ容量に応じたコスト
  - 標準：1GB あたり 0.025USD/月
  - S3 Intelligent Tiering：標準と標準 IA の組合せ
  - 標準 IA：1GB あたり 0.019USD/月
  - One Zone IA：1GB あたり 0.0152USD/月
  - Glacier：1GB あたり 0.005USD/月
  - Glacier deep archive：1GB あたり 0.002USD/月
- EBS の汎用ストレージのコスト
  - 汎用：1GB あたり 0.12USD/月
  - コールド HDD：1GB あたり 0.03USD/月
- EFS ストレージのコスト
  - 標準：1GB あたり 0.36USD/月
  - 低頻度アクセス：0.0272USD/月
- インスタンスストア
  - EC2 インスタンスに含まれる

## リクエスタ支払い

`S3バケットはデータ取得の際にも料金が発生する場合があるため、リクエスタ支払いはデータ取得したアカウントに課金する`

|                      |               データ保存コスト               |                                      データ通信コスト                                      |
| :------------------: | :------------------------------------------: | :----------------------------------------------------------------------------------------: |
| リクエスタ支払い無効 | バケットの所有者がデータ保存のコストを支払う |               バケットの所有者がデータのダウンロードコスト（通信料）を支払う               |
| リクエスタ支払い有効 | バケットの所有者がデータの保存コストを支払う | データダウンロードをリクエストしたアカウントがデータのダウンロードコスト（通信料）を支払う |
